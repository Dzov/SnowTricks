{% extends('base.html.twig') %}

{% form_theme form 'form/file_upload_form_template.html.twig' %}

{% block title %}SnowTricks - Modifier la figure{% endblock %}

{% block body %}
    {% if trick.images is not empty %}
        {% set image = trick.images.first() %}
        <div class="trick_header_image" style="background: url('{{ asset(image.path) }}') center 30%; background-size: cover; height: 300px; width: auto">
            {% include('flash_messages.html.twig') %}
        </div>
        <h3 class="text-md-center mb-4 trick_form_title">Modifier la figure</h3>
    {% else %}
        {% include('flash_messages.html.twig') %}
    {% endif %}
    <section id="tricks_section" class="mx-md-5 my-md-3">
        <div class="modal-body">
            {{ form_start(form, {'attr': {'class': 'd-flex flex-column'}}) }}
            <div class="trick_edit_form d-flex flex-column my-4">
                {% if trick.images is not empty %}
                    <div class="trick__slider--container">
                        <div class="trick__slider--images d-flex align-items-center">
                            {{ form_widget(form.images) }}
                            {% for image in trick.images | reverse %}
                                <div class='mr-3'>
                                    <img src="{{ asset(image.path) }}" alt="Image de la figure {{ trick.name }}" width="105" height="105" class="card trick_form_images_{{ loop.revindex0 }}_file_img">
                                    <div class="controls d-flex justify-content-around">
                                        <label for="trick_form_images_{{ loop.revindex0 }}_file" class="imageEditionPencil">
                                            <i class="fa fa-pencil"></i>
                                        </label>
                                        <label for="deleteInput{{ loop.revindex0 }}" class="imageDeleteButton" id="{{ image.id }}"><i class="fa fa-trash"></i></label>
                                    </div>
                                </div>
                            {% endfor %}
                            {% for video in trick.videos | reverse %}
                                {% if video.identifier is not null and video.platformName is not null %}
                                    <div class='mr-3'>
                                        <iframe width="105" height="105" src="https://www.{{ video.platformName }}.com/embed/{{ video.identifier }}" frameborder="0" allowfullscreen></iframe>
                                        <div class="controls d-flex justify-content-around">
                                            <label for="trick_form_images_{{ loop.revindex0 }}_file" class="imageEditionPencil">
                                                <i class="fa fa-pencil"></i>
                                            </label>
                                            <label for="deleteInput{{ loop.revindex0 }}" class="imageDeleteButton" id="{{ image.id }}"><i class="fa fa-trash"></i></label>
                                        </div>
                                    </div>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                {% endif %}

                <div class="form-group">
                    {% if form_errors(form.images) is not empty %}
                        <div class="alert alert-danger" role="alert">
                            {{ form_errors(form.images) }}
                        </div>
                    {% endif %}

                </div>
                <div class="form-group">
                    {% if form_errors(form.name) is not empty %}
                        <div class="alert alert-danger" role="alert">
                            {{ form_errors(form.name) }}
                        </div>
                    {% endif %}
                    {{ form_label(form.name) }}
                    {{ form_widget(form.name) }}
                </div>
                <div class="form-group">
                    {% if form_errors(form.description) is not empty %}
                        <div class="alert alert-danger" role="alert">
                            {{ form_errors(form.description) }}
                        </div>
                    {% endif %}
                    {{ form_label(form.description) }}
                    {{ form_widget(form.description) }}
                </div>
                <div class="form-group">
                    {% if form_errors(form.category) is not empty %}
                        <div class="alert alert-danger" role="alert">
                            {{ form_errors(form.category) }}
                        </div>
                    {% endif %}
                    {{ form_label(form.category) }}
                    {{ form_widget(form.category) }}
                </div>
                <div class="form-group">
                    {% if form_errors(form.videos) is not empty %}
                        <div class="alert alert-danger" role="alert">
                            {{ form_errors(form.videos) }}
                        </div>
                    {% endif %}
                    {{ form_label(form.videos) }}
                    {{ form_widget(form.videos) }}
                </div>
                <div class="controls d-flex justify-content-around mx-md-3 my-3">
                    <button type="submit" class="btn btn-success mr-md-3">Enregister</button>
                    <button class="btn btn-danger">Supprimer</button>
                </div>
                {{ form_end(form) }}

            </div>
        </div>
    </section>
{% endblock %}
